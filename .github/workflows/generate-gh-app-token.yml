# A reusable Workflow for generating an installation token of a GitHub App. Can be used as a alternative identity/account
# when acting on a repo
# 
# This workflow should and only should be called by others, not act on githuc event

name: Generate GitHub App Token

on:
  workflow_call:
    inputs:
      app-id:
        description: "The ID of the GitHub App."
        required: true
        type: string
      private-key:
        description: "The private key of the GitHub App."
        required: true
        type: string
    outputs:
      token:
        description: "GitHub App installation token"
        value: ${{ jobs.token-generation.outputs.token }}

jobs:
  token-generation:
    name: Generate GH App Token
    runs-on: ubuntu-latest
    outputs:
      token: ${{ steps.generate-token.outputs.token }}
    steps:
      - name: Generate Token
        id: generate-token
        uses: actions/create-github-app-token@v2
        with:
          app-id: ${{ inputs.app-id }}
          private-key: ${{ inputs.private-key }}